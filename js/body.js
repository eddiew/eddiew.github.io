// copyright chris wanstrath
!function(t){function e(e,r,a){var i=this;return this.on("click.pjax",e,function(e){var o=t.extend({},d(r,a));o.container||(o.container=t(this).attr("data-pjax")||i),n(e,o)})}function n(e,n,r){r=d(n,r);var i=e.currentTarget;if("A"!==i.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||location.protocol!==i.protocol||location.hostname!==i.hostname||i.hash&&i.href.replace(i.hash,"")===location.href.replace(location.hash,"")||i.href===location.href+"#")){var o={url:i.href,container:t(i).attr("data-pjax"),target:i},s=t.extend({},o,r),c=t.Event("pjax:click");t(i).trigger(c,[s]),c.isDefaultPrevented()||(a(s),e.preventDefault(),t(i).trigger("pjax:clicked",[s]))}}function r(e,n,r){r=d(n,r);var i=e.currentTarget;if("FORM"!==i.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var o={type:i.method.toUpperCase(),url:i.action,data:t(i).serializeArray(),container:t(i).attr("data-pjax"),target:i};a(t.extend({},o,r)),e.preventDefault()}function a(e){function n(e,n){var a=t.Event(e,{relatedTarget:r});return s.trigger(a,n),!a.isDefaultPrevented()}e=t.extend(!0,{},t.ajaxSettings,a.defaults,e),t.isFunction(e.url)&&(e.url=e.url());var r=e.target,i=p(e.url).hash,s=e.context=f(e.container);e.data||(e.data={}),e.data._pjax=s.selector;var c;e.beforeSend=function(t,r){return"GET"!==r.type&&(r.timeout=0),t.setRequestHeader("X-PJAX","true"),t.setRequestHeader("X-PJAX-Container",s.selector),n("pjax:beforeSend",[t,r])?(r.timeout>0&&(c=setTimeout(function(){n("pjax:timeout",[t,e])&&t.abort("timeout")},r.timeout),r.timeout=0),e.requestUrl=p(r.url).href,void 0):!1},e.complete=function(t,r){c&&clearTimeout(c),n("pjax:complete",[t,r,e]),n("pjax:end",[t,e])},e.error=function(t,r,a){var i=v("",t,e),s=n("pjax:error",[t,r,a,e]);"GET"==e.type&&"abort"!==r&&s&&o(i.url)},e.success=function(r,c,l){var d="function"==typeof t.pjax.defaults.version?t.pjax.defaults.version():t.pjax.defaults.version,f=l.getResponseHeader("X-PJAX-Version"),h=v(r,l,e);if(d&&f&&d!==f)return o(h.url),void 0;if(!h.contents)return o(h.url),void 0;a.state={id:e.id||u(),url:h.url,title:h.title,container:s.selector,fragment:e.fragment,timeout:e.timeout},(e.push||e.replace)&&window.history.replaceState(a.state,h.title,h.url),document.activeElement.blur(),h.title&&(document.title=h.title),s.html(h.contents);var m=s.find("input[autofocus], textarea[autofocus]").last()[0];if(m&&document.activeElement!==m&&m.focus(),g(h.scripts),"number"==typeof e.scrollTo&&t(window).scrollTop(e.scrollTo),""!==i){var x=p(h.url);x.hash=i,a.state.url=x.href,window.history.replaceState(a.state,h.title,x.href);var w=t(x.hash);w.length&&t(window).scrollTop(w.offset().top)}n("pjax:success",[r,c,l,e])},a.state||(a.state={id:u(),url:window.location.href,title:document.title,container:s.selector,fragment:e.fragment,timeout:e.timeout},window.history.replaceState(a.state,document.title));var d=a.xhr;d&&d.readyState<4&&(d.onreadystatechange=t.noop,d.abort()),a.options=e;var d=a.xhr=t.ajax(e);return d.readyState>0&&(e.push&&!e.replace&&(x(a.state.id,s.clone().contents()),window.history.pushState(null,"",l(e.requestUrl))),n("pjax:start",[d,e]),n("pjax:send",[d,e])),a.xhr}function i(e,n){var r={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return a(t.extend(r,d(e,n)))}function o(t){window.history.replaceState(null,"","#"),window.location.replace(t)}function s(e){var n=e.state;if(n&&n.container){if(S&&T==n.url)return;if(a.state.id===n.id)return;var r=t(n.container);if(r.length){var i,s=E[n.id];a.state&&(i=a.state.id<n.id?"forward":"back",w(i,a.state.id,r.clone().contents()));var c=t.Event("pjax:popstate",{state:n,direction:i});r.trigger(c);var u={id:n.id,url:n.url,container:r,push:!1,fragment:n.fragment,timeout:n.timeout,scrollTo:!1};s?(r.trigger("pjax:start",[null,u]),n.title&&(document.title=n.title),r.html(s),a.state=n,r.trigger("pjax:end",[null,u])):a(u),r[0].offsetHeight}else o(location.href)}S=!1}function c(e){var n=t.isFunction(e.url)?e.url():e.url,r=e.type?e.type.toUpperCase():"GET",a=t("<form>",{method:"GET"===r?"GET":"POST",action:n,style:"display:none"});"GET"!==r&&"POST"!==r&&a.append(t("<input>",{type:"hidden",name:"_method",value:r.toLowerCase()}));var i=e.data;if("string"==typeof i)t.each(i.split("&"),function(e,n){var r=n.split("=");a.append(t("<input>",{type:"hidden",name:r[0],value:r[1]}))});else if("object"==typeof i)for(key in i)a.append(t("<input>",{type:"hidden",name:key,value:i[key]}));t(document.body).append(a),a.submit()}function u(){return(new Date).getTime()}function l(t){return t.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function p(t){var e=document.createElement("a");return e.href=t,e}function d(e,n){return e&&n?n.container=e:n=t.isPlainObject(e)?e:{container:e},n.container&&(n.container=f(n.container)),n}function f(e){if(e=t(e),e.length){if(""!==e.selector&&e.context===document)return e;if(e.attr("id"))return t("#"+e.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+e.selector}function h(t,e){return t.filter(e).add(t.find(e))}function m(e){return t.parseHTML(e,document,!0)}function v(e,n,r){var a={};if(a.url=l(n.getResponseHeader("X-PJAX-URL")||r.requestUrl),/<html/i.test(e))var i=t(m(e.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),o=t(m(e.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var i=o=t(m(e));if(0===o.length)return a;if(a.title=h(i,"title").last().text(),r.fragment){if("body"===r.fragment)var s=o;else var s=h(o,r.fragment).first();s.length&&(a.contents=s.contents(),a.title||(a.title=s.attr("title")||s.data("title")))}else/<html/i.test(e)||(a.contents=o);return a.contents&&(a.contents=a.contents.not(function(){return t(this).is("title")}),a.contents.find("title").remove(),a.scripts=h(a.contents,"script[src]").remove(),a.contents=a.contents.not(a.scripts)),a.title&&(a.title=t.trim(a.title)),a}function g(e){if(e){var n=t("script[src]");e.each(function(){var e=this.src,r=n.filter(function(){return this.src===e});if(!r.length){var a=document.createElement("script");a.type=t(this).attr("type"),a.src=t(this).attr("src"),document.head.appendChild(a)}})}}function x(t,e){for(E[t]=e,H.push(t);z.length;)delete E[z.shift()];for(;H.length>a.defaults.maxCacheLength;)delete E[H.shift()]}function w(t,e,n){var r,a;E[e]=n,"forward"===t?(r=H,a=z):(r=z,a=H),r.push(e),(e=a.pop())&&delete E[e]}function j(){return t("meta").filter(function(){var e=t(this).attr("http-equiv");return e&&"X-PJAX-VERSION"===e.toUpperCase()}).attr("content")}function y(){t.fn.pjax=e,t.pjax=a,t.pjax.enable=t.noop,t.pjax.disable=b,t.pjax.click=n,t.pjax.submit=r,t.pjax.reload=i,t.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:j},t(window).on("popstate.pjax",s)}function b(){t.fn.pjax=function(){return this},t.pjax=c,t.pjax.enable=y,t.pjax.disable=t.noop,t.pjax.click=t.noop,t.pjax.submit=t.noop,t.pjax.reload=function(){window.location.reload()},t(window).off("popstate.pjax",s)}var S=!0,T=window.location.href,C=window.history.state;C&&C.container&&(a.state=C),"state"in window.history&&(S=!1);var E={},z=[],H=[];t.inArray("state",t.event.props)<0&&t.event.props.push("state"),t.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/),t.support.pjax?y():b()}(jQuery),$(function(){}),jQuery(window).load(function(){function t(t){return!d||0!=window.orientation&&180!=window.orientation?(n.height()-panels[t].outerHeight())/2+"px":Math.max((n.height()-(panels[t].outerHeight()+o.outerHeight()))/2,30)+"px"}var e={resizeSpeed:300,sizeFactor:11.5,sizeMin:12,sizeMax:24},n=jQuery(window),r=(jQuery(document),jQuery("#main")),a=(r.find(".panel"),jQuery("body")),i=jQuery("html,body,window"),o=jQuery("#footer"),s=jQuery("#wrapper"),c=jQuery("#nav"),u=c.find("a"),l=(jQuery(".jumplink"),[]),p="home",d=(window.location.hash.substring(1),!!("ontouchstart"in window));navigator.userAgent.match(/MSIE ([0-9]+)\./)&&RegExp.$1<=9,d&&u.find("span").remove(),u.each(function(){var t=jQuery(this),e=t.attr("href").substring(1);l[e]=t}),$(document).pjax("#nav a","#main").on("pjax:send",function(){l[p].removeClass("active"),l[id].addClass("active"),r.fadeOut(resizeSpeed/2,"linear")}).on("pjax:complete",function(){var t=r.children(":first");if("pc"!=activeLayout)var e=c.outerHeight();t.outerHeight()+o.outerHeight()+e>n.height()?s.addClass("tall"):s.removeClass("tall");var a=(n.height()-t.outerHeight()-e)/2+"px";s.animate({"padding-top":a},resizeSpeed),r.animate({height:t.outerHeight()},resizeSpeed),i.animate({scrollTop:0},resizeSpeed),r.fadeIn(resizeSpeed/2,"linear")}),a.reposition=function(){var i=n.width()*n.height()/1296e3;a.css("font-size",Math.min(Math.max(Math.floor(i*e.sizeFactor),e.sizeMin),e.sizeMax)+"pt"),r.height(panels[p].outerHeight()),s.css("padding-top",t(p)),c.css("margin-top",-c.outerHeight/2)},addEvent(window,"resize",function(){a.reposition()}),triggerEvent(window,"resize"),s.fadeTo(e.resizeSpeed,1)}),$(function(){function t(t){o.eq(a).removeClass("active"),s.eq(a).removeClass("active"),o.eq(t).addClass("active"),s.eq(t).addClass("active"),a=t}function e(){t((a+1)%o.length)}function n(){r=setInterval(function(){i.is(":hover")?c=!0:e()},4236)}var r,a=0,i=$("#workSlide"),o=i.children(),s=$("#workSlideNav").children(),c=!1;n(),i.mouseleave(function(){c&&(c=!1,clearInterval(r),e(),n())}),s.each(function(e,i){$(i).click(function(){e!=a&&(clearInterval(r),t(e),n())})})});